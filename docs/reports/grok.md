# Tailboard (Crew Feature) - Phase One Implementation Subtitle: Journeyman Jobs - Real-time Crew Coordination for Tramping Linemen

## DESCRIPTION

* *** So this is what I want to have happen with the tailboard screen. When a user clicks on the cruise icon on the bottom NAV and navigates to the tail board screen they're initially shown the screen that's there now where there's nothing no crew selected no nothing you create or join a crew when you click on create or join a crew you go to the I guess on boarding screen ow and and click Create a crew from there you put in your crew name classification all that all that stays the same this is where it changes. When the user clicks and presses on create the crew button what needs to happen is that a document needs to be created in the cruise collection in Firebase that the document ID is the name of the crew plus the server timestamp plus a counter so if this is the first crew that's ever made then it would be whatever the name is whatever the time is and the number one if this is the 10th crew that's made it's whatever the name is whatever the time is and then the number 10. Then the user that created the crew is assigned the role of foreman and that needs to be updated in the user collection or the crew collection and then there needs to be a dialog pop up that the creator or the foreman of the crew can set the preferences for the job searches and these are the same preferences that the user sets during onboarding for hours worked construction type per DM pay rate all of that it's the same search or same preference function and feature just for this crew instead of the user Once that's selected then or once once all of that criteria is set then the user clicks on a button that says done or whatever set and then that writes and stores the preferences to the back end and then the user is immediately navigated back to the cruise or the tail board screen and then now since the user is a foreman of a crew he's part of a crew at the top there is no more welcome to the tail board screen or create a crew or join a crew all of that is replaced with you know the crew name the user input they do not need to see the timestamp and the counter like in the database they only need to see what the name is the user input name of the crew There needs to be a drop down up there for the user for a user to select whatever crew they're part of and whatever crew that they select it changes the entire screen in context related to that specific crew So once the crews established and their preferences are set whenever you go to the job tabs these are where you'll see the jobs that meet the criteria They'll be listed underneath the tab bar the chat tab when you select on whenever you select that this is where you interact with the other members of the crew and chat with those members specifically and only exclusively the Feed tab The feed tab is where any user can post anything and any other user can see it so it's just like a global universal messaging board or feed board if anybody they can post whatever they want on there and anyone can see it and anyone can interact or respond People can share crew invite links there job information whatever making sure and post whatever they want in the feed and every anyone and everyone can see that it's real time real update universal app wide thing***

1. Overview Purpose: Let up to ten IBEW journeymen form a crew-travel together, share job filters, chat in-app. Foreman sets prefs; all members see identical job feed. Hard caps: 3 crews per user, 10 people per crew.
2. Data Model Firestore Collections: crews/{crewId} { name: string, foremanId: string, memberIds: , filters: { payMin: number, maxDistance: number, perDiem: boolean, type: 'transmission' | 'distribution', ... }, createdAt: timestamp } users/{uid} { myCrews: , ...existing profile stuff } jobs { ... } // unchanged
3. Create Flow

* A. Button tap: Create Crew → Modal: Crew name?
* B. On submit: const crewRef = await db.collection('crews').add({ name: input.name, foremanId: auth.currentUser.uid, memberIds: , filters: {}, createdAt: firebase.firestore.FieldValue.serverTimestamp() }); C. Then: update user's myCrews: db.collection('users').doc(uid).update({ myCrews: firebase.firestore.FieldValue.arrayUnion(crewRef.id) });
* D. If user.myCrews.length > 3? Block and alert: You're already maxed out.
* E. Immediately after: navigator.push('/tailboard', { crewId: crewRef.id });
* F. On arrive: trigger filter modal (reuse existing JobFilter component) - just update filters field in crew doc, no new page.

1. Tailboard Screen Layout Top: – Active (green dot if new message) Right: edit icon (foreman-only) Below: tabs → Jobs | Chat | Members If no crew: You're not in a crew yet. Join or create one. Else: dropdown/toggle chips: Crew Alpha | Crew Bravo (only shows crews from your myCrews array) - `Jobs Tab`: useEffect(() => { const q = query(collection(db, 'jobs'), where('pay', '>=', crew.filters?.payMin 0), // add your other where() clauses ); const sub = onSnapshot(q, snap => setJobs(snap.docs)); return () => sub(); }, ); - `Chat Tab`: const msgSub = onSnapshot(collection(db, crews/${crewId}/messages), snap => setMessages(snap.docs)); real-time, append-only, ordered by sentAt. Send button pushes {text, uid, sentAt: serverTimestamp()} to same subcollection. - `Members Tab`: map over memberIds → get their profile (photo, name) from users collection. If uid === crew.foremanId, hide Leave Crew, show Manage Crew maybe. Leave: await updateDoc(crewRef, { memberIds: arrayRemove(uid) }); then remove from user's myCrews: db.collection('users').doc(uid).update({ myCrews: arrayRemove(crewId) }); If foreman leaves and it's the only member? auto-delete crew doc.
2. Crew Picker Component <CrewPicker /> { crews.map(c => <Chip key={c.id} onPress={() => setActiveCrew(c)} active={c.id === activeCrew.id} >{c.name} ({c.memberIds.length}/10)</Chip>) } Re-renders all tabs on switch-no reload.
3. Permissions & Rules Firestore security: match /crews/{crewId} { allow read, write: if request.auth != null && ( resource.data.foremanId == request.auth.uid || resource.data.memberIds.hasAny( ) ); } Subcollection messages: same rule. No peeking.
4. Edge Cases - Maxed at 10 members? Show Crew full on join invite. - User deleted? Cleanup: remove from all memberIds, if crew empty-delete it. - No internet? Cache last 20 jobs + messages with localForage or Firestore offline persistence (enable in config).
5. Next Steps Phase Two: Invite codes. Generate: db.collection('inviteCodes').
